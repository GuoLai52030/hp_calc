<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>è¡€æœˆæ•°å€¼ç»å¯¹æ‹Ÿåˆç‰ˆ</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body { background: #121212; color: #fff; font-family: sans-serif; padding: 20px; }
        .container { max-width: 800px; margin: 0 auto; background: #1e1e1e; padding: 20px; border-radius: 12px; border: 1px solid #333; }
        .flex { display: flex; gap: 20px; }
        .panel { flex: 1; background: #252525; padding: 15px; border-radius: 8px; }
        .stat { font-size: 2em; font-weight: bold; color: #00e5ff; font-family: monospace; }
        .label { color: #888; font-size: 0.8em; margin-bottom: 5px; }
        input { width: 100%; background: #000; border: 1px solid #444; color: #00e5ff; padding: 8px; margin-bottom: 10px; border-radius: 4px; }
        .log-box { margin-top: 15px; font-size: 0.85em; background: #000; padding: 10px; border-radius: 4px; border: 1px dashed #444; }
    </style>
</head>
<body>

<div class="container">
    <h2 style="margin-top:0">ğŸ“Š ä¸¥æ ¼æ•°æ®æ‹Ÿåˆæ¨¡æ‹Ÿå™¨</h2>
    
    <div class="flex">
        <div class="panel">
            <div class="label">å½“å‰å±€å†…æ€»æ”»å‡»åŠ›</div>
            <div id="atkIn" class="stat">122</div>
            <div class="label" style="margin-top:15px">å½“å‰æš´å‡»ä¼¤å®³</div>
            <div id="critDmg" class="stat" style="color: #ff9f43;">202</div>
        </div>
        
        <div class="panel">
            <div class="label">è¯ç¼€ 1 å¢ä¼¤ (%)</div>
            <input type="number" class="bonus" value="40">
            <div class="label">è¯ç¼€ 2 å¢ä¼¤ (%)</div>
            <input type="number" class="bonus" value="80">
            <div class="label">è¯ç¼€ 3 å¢ä¼¤ (%)</div>
            <input type="number" class="bonus" value="40">
            <div class="label">è¯ç¼€ 4 å¢ä¼¤ (%)</div>
            <input type="number" class="bonus" value="80">
        </div>
    </div>

    <div class="log-box">
        <strong>æ‹Ÿåˆæ£€æŸ¥ç‚¹ï¼š</strong><br>
        â€¢ å½“è¯ç¼€ä¸º 40+80 æ—¶ï¼Œæ”»å‡»åŠ›åº”ä¸º <span style="color:#fff">218</span> (å›¾ä¸­æ•°å€¼)<br>
        â€¢ å½“æ”»å‡»åŠ›ä¸º 250 æ—¶ï¼Œæš´å‡»åº”ä¸º <span style="color:#fff">458</span> (å›¾ä¸­æ•°å€¼)
    </div>

    <canvas id="chart" height="150" style="margin-top:20px;"></canvas>
</div>

<script>
    const inputs = document.querySelectorAll('.bonus');
    const atkDisp = document.getElementById('atkIn');
    const critDisp = document.getElementById('critDmg');
    const ctx = document.getElementById('chart').getContext('2d');

    const chart = new Chart(ctx, {
        type: 'line',
        data: {
            labels: ['åˆå§‹', 'è¯ç¼€1', 'è¯ç¼€2', 'è¯ç¼€3', 'è¯ç¼€4'],
            datasets: [{ label: 'æ”»å‡»åŠ›', data: [], borderColor: '#00e5ff', tension: 0.1 }]
        },
        options: { plugins: { legend: { display: false } }, scales: { y: { grid: { color: '#333' } } } }
    });

    function sync() {
        const outAtk = 42;
        const baseDiff = 122 - 42; // 80
        
        let totalBonusPercent = 0;
        let history = [122];

        inputs.forEach(input => {
            totalBonusPercent += (parseFloat(input.value) || 0) / 100;
            // ä¸¥æ ¼æ‰§è¡Œå›¾ 2 é€»è¾‘ï¼š42 + 80 * (1 + ç´¯è®¡ç™¾åˆ†æ¯”)
            const currentAtk = outAtk + baseDiff * (1 + totalBonusPercent);
            history.push(currentAtk);
        });

        const finalAtk = history[history.length - 1];
        // ä¸¥æ ¼æ‰§è¡Œå›¾ 1 é€»è¾‘ï¼š2 * ATK - 42
        const finalCrit = 2 * finalAtk - outAtk;

        atkDisp.innerText = Math.round(finalAtk);
        critDisp.innerText = Math.round(finalCrit);
        
        chart.data.datasets[0].data = history;
        chart.update();
    }

    inputs.forEach(i => i.addEventListener('input', sync));
    sync();
</script>
</body>
</html>
